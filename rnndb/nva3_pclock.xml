<?xml version="1.0" encoding="UTF-8"?>
<database xmlns="http://nouveau.freedesktop.org/"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://nouveau.freedesktop.org/ rules-ng.xsd">
<import file="copyright.xml"/>

<import file="nvchipsets.xml" />

<domain name="NV_MMIO" bare="yes" prefix="chipset">

<bitset name="nva3_nvpll_ctrl" inline="yes">
	<bitfield pos="0" name="ENABLE"/>
	<bitfield low="1" high="2" name="UNK1"/>
	<bitfield pos="3" name="BYPASS"/> <!-- and use the usual clk_id + 10 -->
	<bitfield low="4" high="6" name="UNK4"/>
	<bitfield low="16" high="17" name="UNK16"/>
</bitset>

<bitset name="nva3_mpll_ctrl" inline="yes">
	<bitfield pos="0" name="ENABLE"/>
	<bitfield low="1" high="2" name="UNK1"/>
	<bitfield pos="3" name="BYPASS"/> <!-- and use the usual clk_id + 10 -->
	<bitfield low="4" high="6" name="UNK4"/>
	<bitfield pos="9" name="UNK9"/>
	<bitfield low="16" high="17" name="UNK16"/>
	<bitfield low="27" high="28" name="UNK27"/> <!-- always on -->
</bitset>

<bitset name="nva3_spll_ctrl" inline="yes">
	<doc>bit 16 sometimes is not writable and forced to 0</doc>
	<bitfield pos="0" name="ENABLE"/>
	<bitfield low="1" high="2" name="UNK1"/>
	<bitfield pos="3" name="BYPASS"/> <!-- and use the usual clk_id + 10 -->
	<bitfield low="4" high="6" name="UNK4"/>
	<bitfield low="16" high="17" name="UNK16"/>
</bitset>

<bitset name="nva3_pll_coef" inline="yes">
	<bitfield low="0" high="7" name="M"/>
	<bitfield low="8" high="15" name="N"/>
	<bitfield low="16" high="21" name="P"/>
</bitset>

<bitset name="nva3_pll_src" inline="yes">
	<doc>VCO = (2 * VCO_SRC) / VCO_DIV</doc>
	<bitfield pos="0" name="UNK0"/>
	<bitfield low="4" high="5" name="VCO_SRC">
		<value value="0" name="RPLL1"/>
		<value value="1" name="RPLL1"/>
		<value value="2" name="RPLL1"/>
		<value value="3" name="RPLL2"/>
	</bitfield>
	<bitfield pos="6" name="OUTPUT_1">
		<value value="0" name="100000"/>
		<value value="1" name="108000"/>
	</bitfield>
	<bitfield pos="8" name="ENABLE"/>
	<bitfield low="9" high="10" name="UNK9"/>
	<bitfield low="12" high="13" name="OUTPUT">
		<value value="0" name="CRYSTAL"/>
		<value value="1" name="DISABLED"/>
		<value value="2" name="OUTPUT_1"/>
		<value value="3" name="VCO"/>
	</bitfield>
	<bitfield pos="15" name="UNK15"/>
	<bitfield low="16" high="21" name="VCO_DIV"/>
	<bitfield low="24" high="31" name="UNK24"/>
</bitset>

<array offset="0x4000" name="PCLOCK" stride="0x1000" variants="NVA3:NVC0" length="1">
	<!-- tested on my nva3 only -->
	<reg32 offset="0x000" name="MPLL_CTRL" type="nva3_mpll_ctrl"/>
	<reg32 offset="0x004" name="MPLL_COEF" type="nva3_pll_coef"/>

	<reg32 offset="0x120" name="PLL_CLK_SRC1" stride="0x4" length="0x10" type="nva3_pll_src"/>
	<reg32 offset="0x160" name="PLL_CLK_SRC2" stride="0x4" length="0x10" type="nva3_pll_src"/>

	<reg32 offset="0x1a0" name="PLL_CLK_SRC3" stride="0x4" length="0x2" type="nva3_pll_src"/>

	<reg32 offset="0x200" name="NVPLL_CTRL" type="nva3_nvpll_ctrl"/>
	<reg32 offset="0x204" name="NVPLL_COEF" type="nva3_pll_coef"/>
	<reg32 offset="0x220" name="SPLL_CTRL" type="nva3_spll_ctrl"/>
	<reg32 offset="0x224" name="SPLL_COEF" type="nva3_pll_coef"/>
</array>

<array offset="0xc000" name="PCONTROL" stride="0x1000" variants="NVA3:NVC0" length="1">
</array>

</domain>

</database>
